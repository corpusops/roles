- environment:
    DEBIAN_FRONTEND: noninteractive
  block:
  - shell: |-
      set -ex
      cd /usr/src
      for i in \
      gir1.2-polkit-1.0_0.105-4ubuntu3.14.04.9_amd64.deb \
      libpolkit-agent-1-0_0.105-4ubuntu3.14.04.9_amd64.deb \
      libpolkit-agent-1-dev_0.105-4ubuntu3.14.04.9_amd64.deb \
      libpolkit-backend-1-0_0.105-4ubuntu3.14.04.9_amd64.deb \
      libpolkit-backend-1-dev_0.105-4ubuntu3.14.04.9_amd64.deb \
      libpolkit-gobject-1-0_0.105-4ubuntu3.14.04.9_amd64.deb \
      libpolkit-gobject-1-dev_0.105-4ubuntu3.14.04.9_amd64.deb \
      policykit-1-doc_0.105-4ubuntu3.14.04.9_all.deb \
      policykit-1_0.105-4ubuntu3.14.04.9_amd64.deb \
      ;do wget -c "https://github.com/corpusops/old-debs-packaging/releases/download/debs/$i"
      done
      dpkg -i $(ls $(dpkg -l|egrep "^ii\s+policykit|libpolkit"|awk '{print $2}'|grep -v build-deps|sed -re "s/:.*//g;;s/$/*/g;s/^/.\//g"))
    when:
    - "(ansible_distribution=='Ubuntu' and (ansible_distribution_version[:2]|int)==14)"
  - shell: |-
      set -ex
      cd /usr/src
      for i in \
      gir1.2-polkit-1.0_0.105-14.1ubuntu0.6_amd64.deb \
      libpolkit-agent-1-0_0.105-14.1ubuntu0.6_amd64.deb \
      libpolkit-agent-1-dev_0.105-14.1ubuntu0.6_amd64.deb \
      libpolkit-backend-1-0_0.105-14.1ubuntu0.6_amd64.deb \
      libpolkit-backend-1-dev_0.105-14.1ubuntu0.6_amd64.deb \
      libpolkit-gobject-1-0_0.105-14.1ubuntu0.6_amd64.deb \
      libpolkit-gobject-1-dev_0.105-14.1ubuntu0.6_amd64.deb \
      policykit-1-doc_0.105-14.1ubuntu0.6_all.deb \
      policykit-1_0.105-14.1ubuntu0.6_amd64.deb \
      ;do wget -c "https://github.com/corpusops/old-debs-packaging/releases/download/debs/$i"
      done
      apt-get install -y $(ls $(dpkg -l|egrep "^ii\s+policykit|libpolkit"|awk '{print $2}'|grep -v build-deps|sed -re "s/:.*//g;;s/$/*/g;s/^/.\//g"))
    when:
    - "(ansible_distribution=='Ubuntu' and (ansible_distribution_version[:2]|int)==16)"
  - shell: |-
      set -ex
      apt update -qq
      pkgs=$(dpkg -l|egrep "ii\s+libpolkit|policykit"|awk '{print $2}')
      apt install -y $pkgs
    when:
    - "(ansible_distribution=='Ubuntu' and (ansible_distribution_version[:2]|int)>=18)"
