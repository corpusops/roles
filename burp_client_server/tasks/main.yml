---
- tags: [cops_burpclientserver_vars]
  block:
  - include_jinja_vars:
      content: |-
        ---
        {% set prefix = 'cops_burpclientserver_' %}
        {% set snamespaced, vars = vars|copsf_registry(prefix) %}
        {% set data = snamespaced[prefix+'vars'] %}
        {%- if data.use_profile and data.profile %}
        {%-   set r = (data.custom_lines|copsf_deepcopy) %}
        {%-   set _ = r.append(data.get('profiles_'+data.profile, '')) %}
        {%-   set _ = data.update({'custom_lines': r})%}
        {%- endif %}
        {{ (snamespaced[prefix+'vars']
            |copsf_format_resolve(additional_namespaces=[vars])
            |copsf_registry_to_vars(vars, prefix, global_scope=True)
           )[0]
           | to_json}}
    no_log: "{{not (cops_vars_debug|default(false))}}"
- include_tasks: run.yml
  tags: [cops_burpclientserver_server]
  no_log: "{{not (cops_vars_debug|default(false))}}"

