---
- listen: [restart_docker_compose_service]
  systemd:
    daemon_reload: yes
    state: "{{docker_compose_service_vars.state}}"
    name: "{{item}}"
  with_items: ["{{docker_compose_service_vars.project}}"]
  tags: [service, systemd_do]
  when: "(corpusops_vars.has_services_manager and
          docker_compose_service_vars.state and
          docker_compose_service_vars.state not in ['started', 'stopped']  and
          (ansible_service_mgr == 'systemd'))"
- listen: [restart_docker_compose_service]
  service:
    state: "{{docker_compose_service_vars.state}}"
    name: "{{item}}"
  with_items: ["{{docker_compose_service_vars.project}}"]
  tags: [service, service_do]
  when: "(corpusops_vars.has_services_manager and
          (docker_compose_service_vars.state | copsf_asbool) and
          docker_compose_service_vars.state not in ['started', 'stopped']  and
          (ansible_service_mgr in ['upstart']))"
- meta: flush_handlers
