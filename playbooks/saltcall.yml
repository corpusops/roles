---
# execute a salt call on a host
# ansible-playbook  -v  plays/saltcall.yml \
#       -e "saltargs=makina-states.localsettings.users"
#
# ansible-playbook  -v  plays/saltcall.yml \
#       -e "function=test.ping"
#
# ansible-playbook  -v  plays/saltcall.yml \
#       -e "function=cmd.run saltargs='cmd=\"ls /\" python_shell=True'"

- hosts: "{{hosts|default('all')}}"
  roles: [makinastates_pillar]

- hosts: "{{hosts|default('all')}}"
  tasks:
    - name: >
            salt-call
            {{function|default('state.sls')}}
            {{saltargs|default('')}}
      saltcall:
        function: "{{function|default('state.sls')}}"
        args: "{{saltargs|default('')}}"
